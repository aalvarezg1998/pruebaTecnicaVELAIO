
<form [formGroup]="form" class="form-container responsive-container">
<div formArrayName="persons">
    <div *ngFor="let person of persons.controls; let i = index" [formGroupName]="i">
        <div class="card">
            <div class="card-content">
                <div class="card-title">
                    Agregar nueva persona
                </div>
                <div class="responsive-container">
                    <div class="form-item">
                        <label for="namePerson">Nombre de la Persona <span class="color-error">*</span></label>
                        <input id="namePerson" formControlName="namePerson" type="text" class="form-control" />
                        <div *ngIf="person.get('namePerson')?.invalid && person.get('namePerson')?.touched" class="error-message">
                            El nombre debe tener minÃ­mo 5 letras.
                        </div>
                    </div>
        
                    <div class="form-item">
                        <label for="age">Edad <span class="color-error">*</span></label>
                        <input id="age" formControlName="age" type="number" class="form-control" />
                        <div *ngIf="person.get('age')?.invalid && person.get('age')?.touched" class="error-message">
                            La persona debe ser mayor de edad.
                        </div>
                    </div>
                </div>
                <div formArrayName="skills">
                    <div class="card-subtitle">
                        Habilidades de <strong>{{ person.get('namePerson')?.value }}</strong> 
                    </div>
                <div *ngFor="let skill of getSkills(i).controls; let j = index" [formGroupName]="j">
                    <div class=" responsive-container">
                        <div class="form-item">
                            <label for="nameSkiller">Nombre de la habilidad <span class="color-error">*</span></label>
                            <input id="nameSkiller" formControlName="nameSkiller" type="text" class="form-control" />
                            <div *ngIf="skill.get('nameSkiller')?.invalid && skill.get('nameSkiller')?.touched" class="error-message">
                                Cada persona debe tener una habilidad.
                            </div>
                        </div>
                        <div class="gap actions-button">
                            <button [disabled]="j === 0" type="button" class="delete-button center" (click)="removeSkill(i, j)">
                                <div class="center">
                                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#333333"><path d="M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z"/></svg>
                                </div>
                            </button>
                            <button type="button" class="add-button center" (click)="addSkill(i)">
                                <div class="center">
                                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#333333"><path d="M440-440H200v-80h240v-240h80v240h240v80H520v240h-80v-240Z"/></svg>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
                </div>
                <div class="form-item responsive-container" style="margin-bottom: 20px;">
                    <button [disabled]="i === 0" type="button" class="delete-person-button" (click)="removePerson(i)">
                        <div class="center gap">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#333333"><path d="M640-520v-80h240v80H640Zm-280 40q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM40-160v-112q0-34 17.5-62.5T104-378q62-31 126-46.5T360-440q66 0 130 15.5T616-378q29 15 46.5 43.5T680-272v112H40Zm80-80h480v-32q0-11-5.5-20T580-306q-54-27-109-40.5T360-360q-56 0-111 13.5T140-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T440-640q0-33-23.5-56.5T360-720q-33 0-56.5 23.5T280-640q0 33 23.5 56.5T360-560Zm0-80Zm0 400Z"/></svg>
                            Eliminar
                        </div>
                    </button>
                    <button type="button" class="add-person-button" (click)="addPerson()">
                        <div class="center gap">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#333333"><path d="M720-400v-120H600v-80h120v-120h80v120h120v80H800v120h-80Zm-360-80q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM40-160v-112q0-34 17.5-62.5T104-378q62-31 126-46.5T360-440q66 0 130 15.5T616-378q29 15 46.5 43.5T680-272v112H40Zm80-80h480v-32q0-11-5.5-20T580-306q-54-27-109-40.5T360-360q-56 0-111 13.5T140-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T440-640q0-33-23.5-56.5T360-720q-33 0-56.5 23.5T280-640q0 33 23.5 56.5T360-560Zm0-80Zm0 400Z"/></svg>
                            Agregar
                        </div>  
                    </button>
                </div>
            </div>
        </div>
    </div>
    </div>
</form>